// Project data with details
const projectsData = {
  'TMS v2': {
    title: 'Traffic Management System v2',
    description: 'ëŒ€ê·œëª¨ êµí†µ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ì—¬ íš¨ìœ¨ì ì¸ êµí†µ ìš´ì˜ê³¼ ì •ì±… ìˆ˜ë¦½ì„ ì§€ì›í•˜ëŠ” ì§€ëŠ¥í˜• êµí†µ ì˜ìƒë¶„ì„ ëª¨ë‹ˆí„°ë§ ì†Œí”„íŠ¸ì›¨ì–´ì…ë‹ˆë‹¤. GIS ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì‹œê°„ êµí†µ ì˜ìƒê³¼ AI ë¶„ì„ ì •ë³´ë¥¼ ì‹œê°ì ìœ¼ë¡œ ì œê³µí•˜ë©°, Interactive Chartë¥¼ ì´ìš©í•˜ì—¬ ê° êµì°¨ë¡œì™€ ì ‘ê·¼ë¡œì˜ ëŒ€ê·œëª¨ êµí†µì •ë³´ë¥¼ ì‰½ê²Œ ì¡°íšŒí•˜ê³  ë¹„êµë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
    tech: ['Vue.js', 'Node.js', 'MariaDB'],
    image: 'images/projects/tmsv2_1.png',
    image2: 'images/projects/tmsv2_2.png',
    link: 'https://naver.me/Gypx25qw',
    demoVideo: true,
    team: '2ëª…',
    role: 'í’€ìŠ¤íƒ ê°œë°œ',
    deployed: 'ì•ˆì–‘ì‹œ, í™”ì„±ì‹œ, ë¶€ì²œì‹œ, ì„±ë‚¨ì‹œ, ê´‘ì–‘ì‹œ',
    details: [
      'Vue.js + Express.js ê¸°ë°˜ í’€ìŠ¤íƒ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ',
      'ì‹¤ì‹œê°„ êµí†µ ë°ì´í„° ë¶„ì„ API ì„¤ê³„ ë° êµ¬í˜„ (ë‹¤ì¸µ ë¶„ì„: ê¶Œì—­â†’êµì°¨ë¡œâ†’ì ‘ê·¼ë¡œâ†’ì°¨ì¢…)',
      'WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ ì˜ìƒ ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œ êµ¬ì¶•, Fabric.js Canvas ì˜¤ë²„ë ˆì´ë¡œ ì‹¤ì‹œê°„ ê°ì²´ í‘œì‹œ',
      'ì¹´ì¹´ì˜¤ë§µ API ì—°ë™ GIS ê¸°ë°˜ êµí†µ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ê°œë°œ',
      'JWT ê¸°ë°˜ ì¸ì¦ ë° bcrypt ì•”í˜¸í™”ë¥¼ ì ìš©í•œ ê¶Œí•œ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„',
      'LOS(ì„œë¹„ìŠ¤ìˆ˜ì¤€) ë¶„ì„ ì•Œê³ ë¦¬ì¦˜ ë° ì‹ í˜¸ì œì–´ ì—°ê³„ ë¶„ì„ ê¸°ëŠ¥ ê°œë°œ'
    ]
  },
  'TMS v3': {
    title: 'Traffic Management System v3',
    description: 'TMS v2ì˜ í›„ì† ë²„ì „ìœ¼ë¡œ, Docker ê¸°ë°˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ë¥¼ ë„ì…í•˜ì—¬ í™•ì¥ì„±ê³¼ ì•ˆì •ì„±ì„ ê°•í™”í•œ ì§€ëŠ¥í˜• êµí†µ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. GIS ë©€í‹°ë ˆì´ì–´ë¥¼ í†µí•´ êµí†µì¶•, ì‹ í˜¸ì œì–´, ì™¸ë¶€ CCTV ë“± ë‹¤ì–‘í•œ ì •ë³´ë¥¼ í†µí•© ì œê³µí•˜ë©°, ë°”ë‹¥ ì‹ í˜¸, ì •ë°€ ì§€ë„, ì‹œê³µê°„ í˜¼ì¡ë„ ë¶„ì„ ë“± ê³ ê¸‰ ê¸°ëŠ¥ì„ ì§€ì›í•©ë‹ˆë‹¤.',
    tech: ['Vue.js', 'Node.js', 'PostgreSQL'],
    image: 'images/projects/tmsv3_1.png',
    image2: 'images/projects/tmsv3_2.png',
    link: 'http://localhost:9500',
    demoLogin: { id: 'laon2022', pw: 'laon2022!' },
    team: 'FE 3ëª…, BE 4ëª…',
    role: 'í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ',
    deployed: 'ì•ˆì–‘ì‹œ, ì•ˆë™ì‹œ, ë‚¨ì–‘ì£¼ì‹œ',
    details: [
      'Vue 3 Composition API ê¸°ë°˜ ê¸°ì¡´ Vue 2 Options API ì•„í‚¤í…ì²˜ ë§ˆì´ê·¸ë ˆì´ì…˜ ë° ì»´í¬ë„ŒíŠ¸ ë¦¬íŒ©í† ë§',
      'Kakao Maps API ê¸°ë°˜ ì‹¤ì‹œê°„ êµí†µ ê´€ì œ GIS ì‹œìŠ¤í…œ êµ¬í˜„ (6ê°œ ë‹¤ì¤‘ ë ˆì´ì–´ í† ê¸€ ì œì–´, 8ê°€ì§€ êµí†µ ì§€í‘œ ì‹¤ì‹œê°„ ì‹œê°í™”, ì‹œê³µê°„ í˜¼ì¡ë„ ë¶„ì„)',
      'WebSocket + JMuxer ê¸°ë°˜ H.264 ì˜ìƒ ì‹¤ì‹œê°„ ë””ì½”ë”© ë° Canvas ì˜¤ë²„ë ˆì´ ë©”íƒ€ë°ì´í„° ë™ê¸°í™” ë Œë”ë§',
      'ECharts + Axios ê¸°ë°˜ êµì°¨ë¡œ ë¹„êµë¶„ì„ ì‹œìŠ¤í…œ êµ¬í˜„ (ë‹¤ì¤‘ ì„ íƒ í•„í„°ë§, ì‹œë³„/ì¼ë³„/ì›”ë³„ ì§‘ê³„ API ì—°ë™, Stack/Line/Bar ì°¨íŠ¸ ë™ì  ì „í™˜)',
      'ì›”ê°„/í†µí•© ë¦¬í¬íŠ¸ ìë™ ìƒì„± ë° ExcelJS ê¸°ë°˜ ë°ì´í„° Export ê¸°ëŠ¥ êµ¬í˜„',
      'ë„ì‹œ-êµ¬ì—­-êµì°¨ë¡œ 3ë‹¨ê³„ ê³„ì¸µ êµ¬ì¡° ê¸°ë°˜ í–‰ì •êµ¬ì—­ CRUD ë° ì¹´ë©”ë¼ ë§¤í•‘ ì„¤ì • ê¸°ëŠ¥ êµ¬í˜„',
    ]
  },
  'TAS v2': {
    title: 'Traffic Analysis System v2',
    description: 'ì˜ìƒì¥ì¹˜ë¡œë¶€í„° ìŠ¤íŠ¸ë¦¬ë° ì¤‘ì¸ ì˜ìƒì„ ìˆ˜ì‹ ë°›ì•„ AI ê¸°ìˆ ì„ ì´ìš©í•˜ì—¬ ì°¨ëŸ‰, ë³´í–‰ì ë“±ì˜ ê°ì²´ë¥¼ ì¸ì‹í•˜ì—¬ êµí†µ ì •ë³´ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆë„ë¡ ì¹´ë©”ë¼ ë° êµì°¨ë¡œ ì •ë³´ì™€ ROI(Region Of Interest) ì˜ì—­ë“¤ì„ ì„¤ì •í•˜ê³  ì¥ë¹„ì—°ê²° ìƒíƒœ ë° ë¶„ì„ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ì…ë‹ˆë‹¤.',
    tech: ['Vue.js', 'Node.js', 'MariaDB'],
    image: 'images/projects/tas_1.png',
    image2: 'images/projects/tas_2.png',
    link: 'http://localhost:9501',
    demoLogin: { id: 'admin', pw: 'admin' },
    team: 'FE 1ëª…, BE 1ëª…',
    role: 'í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ',
    deployed: 'ì•ˆì–‘ì‹œ, ì•ˆë™ì‹œ, ê´‘ì–‘ì‹œ, ì„±ë‚¨ì‹œ',
    details: [
      'ğŸ† GSì¸ì¦ 1ë“±ê¸‰ íšë“ (êµ­ê°€ ê³µì¸ ì†Œí”„íŠ¸ì›¨ì–´ í’ˆì§ˆ ì¸ì¦)',
      'Vuex ê¸°ë°˜ ê³„ì¸µ êµ¬ì¡°(êµì°¨ë¡œ-ì ‘ê·¼ë¡œ-ì¹´ë©”ë¼) ìƒíƒœ ê´€ë¦¬',
      'SHA-256 ê¸°ë°˜ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ë° í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ê°„ ë¹„ë°€í‚¤ ì•”í˜¸í™” í†µì‹  êµ¬í˜„',
      'Access Token / Refresh Token ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œ êµ¬ì¶•',
      'ë‹¤ì¤‘ í´ë¼ì´ì–¸íŠ¸ ë™ì‹œ ì ‘ì† ì •ì±…ì— ë”°ë¥¸ ì„¸ì…˜ ê´€ë¦¬ êµ¬í˜„',
      'ì „ì²´ ì…ë ¥ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ ë° ìµœëŒ€ê°’ ì œí•œ ì ìš©',
      'ì‚¬ìš©ì ì˜¤ì¡°ì‘ ë°©ì§€ë¥¼ ìœ„í•œ í™•ì¸ ì•ŒëŒ ë° ê²½ê³  ì‹œìŠ¤í…œ êµ¬í˜„',
      'ì²´ê³„ì ì¸ ì˜¤ë¥˜ ì²˜ë¦¬ ë° ì‹œìŠ¤í…œ ë¡œê·¸ ê¸°ë¡ ê¸°ëŠ¥ êµ¬í˜„'
    ]
  },
  'TNS': {
    title: 'Traffic Notify System',
    description: 'VVDS(ì°¨ëŸ‰ê²€ì§€ì‹œìŠ¤í…œ), CCTV, IDS(ëŒë°œê²€ì§€ì‹œìŠ¤í…œ)ë¡œë¶€í„° ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ì •ì²´ ìƒí™©ì„ ê°ì§€í•˜ê³ , VMS(ì „ê´‘íŒ)ì— êµí†µ íë¦„ ê°œì„  ë° ì•ˆì „ì„ ìœ„í•œ ì •ì²´ ì•Œë¦¼ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ì…ë‹ˆë‹¤.',
    tech: ['Vue.js'],
    image: 'images/projects/tns.png',
    image2: 'images/projects/tns_2.png',
    link: 'https://naver.me/xI1Nwu0i',
    demoVideo: true,
    team: 'FE 1ëª…, BE 1ëª…',
    role: 'í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ',
    deployed: 'ì•ˆì–‘ì‹œ, ì•ˆë™ì‹œ, ê´‘ì–‘ì‹œ, ì„±ë‚¨ì‹œ',
    details: [
      'WebSocket + JMuxer ê¸°ë°˜ ì‹¤ì‹œê°„ CCTV ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œ êµ¬ì¶•, Canvas ì˜¤ë²„ë ˆì´ë¡œ íƒì§€ëœ ê°ì²´ì˜ ì •ë³´ë¥¼ ì˜ìƒ ìœ„ì— í‘œì¶œ',
      'ì¹´ì¹´ì˜¤ë§µê¸°ë°˜ GIS ì‹œìŠ¤í…œ ê°œë°œ, êµ¬ê°„/ì§€ì /ì¹´ë©”ë¼ ìœ„ì¹˜ ë° ì‹¤ì‹œê°„ êµí†µ ì •ë³´ ì‹œê°í™”',
      'IntersectionObserver APIë¡œ ë·°í¬íŠ¸ ê°€ì‹œì„± ê°ì§€, í™”ë©´ì— ë³´ì´ëŠ” ì˜ìƒë§Œ ì¬ìƒí•˜ê³  ë²—ì–´ë‚œ ì˜ìƒì€ ìë™ ì •ì§€í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 60% ê°ì†Œ',
      'Vuex ê¸°ë°˜ ì „ì—­ ìƒíƒœ ê´€ë¦¬ ì²´ê³„ êµ¬ì¶• (ì§€ë„ ì œì–´/UI ìƒíƒœ/ë°ì´í„° ìƒíƒœ í†µí•©)',
      '10ì´ˆ ì£¼ê¸° í´ë§ ê¸°ë°˜ ì‹¤ì‹œê°„ ë°ì´í„° ê°±ì‹  ì‹œìŠ¤í…œ êµ¬í˜„'
    ]
  },
  'Talk100': {
    title: 'Talk100',
    description: "'ê¹€ì¬ìš°ì˜ ì˜ì–´íšŒí™” 100' ìˆ˜ê°•ìƒì„ ìœ„í•˜ì—¬ êµì¬ ë¬¸ì¥ì„ íš¨ê³¼ì ìœ¼ë¡œ ì•”ê¸°í•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. ì›ì–´ë¯¼ ìŒì„± ì²­ì·¨, ê°œì¸ ë§ì¶¤í˜• ì§‘ì¤‘ì•”ê¸° ëª¨ë“œ, ìƒì„¸ í•™ìŠµ ë¦¬í¬íŠ¸ ê¸°ëŠ¥ì„ í•µì‹¬ìœ¼ë¡œ, ì‚¬ìš©ìê°€ ìì‹ ë§Œì˜ í•™ìŠµ íŒ¨í„´ì„ ë§Œë“¤ì–´ ì²´ê³„ì ìœ¼ë¡œ ì˜ì–´ ì‹¤ë ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    responsive: true,
    tech: ['React', 'Vite', 'Node.js', 'Express.js', 'PostgreSQL'],
    image: 'images/projects/home/talk100.png',
    image2: ['images/projects/talk100_2.png', 'images/projects/talk100_3.png'],
    link: '#',
    team: '1ëª…',
    role: 'ë””ìì¸, í’€ìŠ¤íƒ ê°œë°œ',
    deployed: 'Cloudflare Pages',
    mobileApp: true,
    details: [
      'React 19 + Vite ê¸°ë°˜ SPA ê°œë°œ, React Routerë¡œ í˜ì´ì§€ ë¼ìš°íŒ… êµ¬í˜„',
      'Web Speech API ê¸°ë°˜ ìŒì„± ì¸ì‹ ë° TTS(Text-to-Speech) ê¸°ëŠ¥ êµ¬í˜„',
      'OAuth 2.0 ê¸°ë°˜ Google ì†Œì…œ ë¡œê·¸ì¸ ì—°ë™',
      'Express.js + PostgreSQL ë°±ì—”ë“œ API ì„œë²„ êµ¬ì¶•',
      'Cloudflare Pages(í”„ë¡ íŠ¸) + Tunnel(ë°±ì—”ë“œ) ì¡°í•©ìœ¼ë¡œ ë¬´ë£Œ ë°°í¬ í™˜ê²½ êµ¬ì„±'
    ]
  },
  'Hotube': {
    title: 'Hotube',
    description: 'ë¹„ê³µê°œ YouTube ì˜ìƒì„ ê°€ì¡± êµ¬ì„±ì›ë§Œ ì‹œì²­í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•œ í”„ë¼ì´ë¹— ì˜ìƒ í”Œë«í¼ì…ë‹ˆë‹¤. ê°€ì¡±ì˜ ì†Œì¤‘í•œ ìˆœê°„ì„ ì•ˆì „í•˜ê²Œ ê³µìœ í•˜ê³  ê°ìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
    responsive: true,
    tech: ['React', 'Firebase', 'Firestore'],
    image: 'images/projects/home/hotube.png',
    image2: 'images/projects/hotube.png',
    link: 'https://transcendent-cocada-9a2381.netlify.app/',
    team: '1ëª…',
    role: 'ë””ìì¸, í’€ìŠ¤íƒ ê°œë°œ',
    deployed: 'Netlify',
    mobileApp: true,
    details: [
      'React 19 + Vite + Tailwind CSS ê¸°ë°˜ ë°˜ì‘í˜• SPA ê°œë°œ (ë‹¤í¬ëª¨ë“œ, URL ìƒíƒœ ë™ê¸°í™”)',
      'YouTube Data API ì—°ë™ìœ¼ë¡œ ì˜ìƒ ë©”íƒ€ë°ì´í„° ìë™ ì¶”ì¶œ ë° Shorts ìë™ ê°ì§€ ë¡œì§ êµ¬í˜„',
      'Firebase Cloud Functions + Firestore ê¸°ë°˜ ì„œë²„ë¦¬ìŠ¤ REST API ì„¤ê³„ ë° êµ¬í˜„',
      'ë‹¤ì¤‘ ë·° ëª¨ë“œ(All/Long-form/Shorts/Timeline) ë° ì—°ë„/ì›”ë³„ ê·¸ë£¹í•‘ íƒ€ì„ë¼ì¸ UI êµ¬í˜„',
      'YouTube IFrame API í™œìš© ì˜ìƒ í”Œë ˆì´ì–´ ë° ìë™ ì¬ìƒ ê¸°ëŠ¥ ê°œë°œ'
    ]
  },
  'Project #7': {
    title: 'Project #7',
    description: 'Clone coding project focusing on HTML and CSS fundamentals. A great learning experience for understanding web layout principles.',
    tech: ['HTML', 'CSS', 'JavaScript'],
    image: 'images/projects/youtube.png',
    link: '#'
  },
  'Project #8': {
    title: 'Project #8',
    description: 'Mobile-first clone coding project. Demonstrates responsive design techniques and mobile UI patterns.',
    tech: ['HTML', 'CSS', 'JavaScript'],
    image: 'images/projects/youtube.png',
    link: '#'
  }
};

// DOM Elements
const modal = document.getElementById('projectModal');
const modalImg = modal.querySelector('.modal__img');
const modalTitle = modal.querySelector('.modal__title');
const modalDescription = modal.querySelector('.modal__description');
const modalLink = modal.querySelector('.modal__link');
const modalClose = modal.querySelector('.modal__close');
const modalOverlay = modal.querySelector('.modal__overlay');
const modalTeam = modal.querySelector('.modal__team');
const modalRole = modal.querySelector('.modal__role');
const modalDeployed = modal.querySelector('.modal__deployed');
const modalInfo = modal.querySelector('.modal__info');
const modalDetailsList = modal.querySelector('.modal__details-list');
const modalImgDetails = modal.querySelector('.modal__img--details');
const modalImgDetails2 = modal.querySelector('.modal__img--details2');
const modalImgContainer = modal.querySelector('.modal__img-container');
const modalTechListPage2 = modal.querySelector('.modal__tech-list--page2');
const modalSlides = modal.querySelector('.modal__slides');
const modalNavPrev = modal.querySelector('.modal__nav--prev');
const modalNavNext = modal.querySelector('.modal__nav--next');
const modalIndicators = modal.querySelectorAll('.modal__indicator');
const projects = document.querySelectorAll('.project');

let currentPage = 0;
let hasDetails = false;

// Update navigation state
function updateNavigation() {
  if (currentPage === 0) {
    modalNavPrev.classList.remove('visible');
    if (hasDetails) {
      modalNavNext.classList.remove('hidden');
    } else {
      modalNavNext.classList.add('hidden');
    }
  } else {
    modalNavPrev.classList.add('visible');
    modalNavNext.classList.add('hidden');
  }

  // Update indicators
  modalIndicators.forEach((indicator, index) => {
    if (index === currentPage) {
      indicator.classList.add('modal__indicator--active');
    } else {
      indicator.classList.remove('modal__indicator--active');
    }
  });
}

// Navigate to page
function goToPage(page) {
  currentPage = page;
  if (page === 0) {
    modalSlides.classList.remove('slide-to-details');
  } else {
    modalSlides.classList.add('slide-to-details');
  }
  updateNavigation();
}

// Open modal with project data
function openModal(projectTitle) {
  const project = projectsData[projectTitle];
  if (!project) return;

  // Reset to first page
  currentPage = 0;
  modalSlides.classList.remove('slide-to-details');

  modalImg.src = project.image;
  modalImg.alt = project.title;

  // Apply mobile app style for smaller image height
  if (project.mobileApp) {
    modalImg.classList.add('modal__img--mobile');
  } else {
    modalImg.classList.remove('modal__img--mobile');
  }

  modalTitle.textContent = project.title;
  modalDescription.textContent = project.description;
  modalLink.href = project.link;

  // Show/hide additional info
  if (project.team || project.role) {
    modalInfo.style.display = 'flex';
    modalTeam.textContent = project.team || '';
    modalRole.textContent = project.role || '';
  } else {
    modalInfo.style.display = 'none';
  }

  if (project.deployed) {
    modalDeployed.style.display = 'block';
    modalDeployed.innerHTML = '<i class="fa-solid fa-location-dot"></i> ë°°í¬: ' + project.deployed;
  } else {
    modalDeployed.style.display = 'none';
  }

  // Populate tech list (page 2 only)
  modalTechListPage2.innerHTML = '';
  project.tech.forEach(tech => {
    const li = document.createElement('li');
    li.textContent = tech;
    modalTechListPage2.appendChild(li);
  });

  // Populate details list and second image
  hasDetails = project.details && project.details.length > 0;
  modalDetailsList.innerHTML = '';
  if (hasDetails) {
    project.details.forEach(detail => {
      const li = document.createElement('li');
      li.textContent = detail;
      modalDetailsList.appendChild(li);
    });
    // Set second image(s) if available
    if (project.image2) {
      if (Array.isArray(project.image2)) {
        // Multiple images - show side by side
        modalImgContainer.classList.add('dual-image');
        modalImgDetails.src = project.image2[0];
        modalImgDetails.alt = project.title + ' screenshot 2';
        modalImgDetails.style.display = 'block';
        modalImgDetails2.src = project.image2[1];
        modalImgDetails2.alt = project.title + ' screenshot 3';
      } else {
        // Single image
        modalImgContainer.classList.remove('dual-image');
        modalImgDetails.src = project.image2;
        modalImgDetails.alt = project.title + ' screenshot 2';
        modalImgDetails.style.display = 'block';
      }
    } else {
      modalImgContainer.classList.remove('dual-image');
      modalImgDetails.style.display = 'none';
    }
  } else {
    modalImgContainer.classList.remove('dual-image');
    modalImgDetails.style.display = 'none';
  }

  updateNavigation();
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
}

// Close modal
function closeModal() {
  modal.classList.remove('active');
  document.body.style.overflow = '';
  // Reset to first page when closing
  currentPage = 0;
  modalSlides.classList.remove('slide-to-details');
}

// Event listeners
projects.forEach(project => {
  project.addEventListener('click', (e) => {
    e.preventDefault();
    const title = project.querySelector('.project__title').textContent;
    openModal(title);
  });
});

modalClose.addEventListener('click', closeModal);
modalOverlay.addEventListener('click', closeModal);

// Navigation arrows
modalNavNext.addEventListener('click', () => {
  if (hasDetails && currentPage === 0) {
    goToPage(1);
  }
});

modalNavPrev.addEventListener('click', () => {
  if (currentPage === 1) {
    goToPage(0);
  }
});

// Close on ESC key, navigate with arrow keys
document.addEventListener('keydown', (e) => {
  if (!modal.classList.contains('active')) return;

  if (e.key === 'Escape') {
    closeModal();
  } else if (e.key === 'ArrowRight' && hasDetails && currentPage === 0) {
    goToPage(1);
  } else if (e.key === 'ArrowLeft' && currentPage === 1) {
    goToPage(0);
  }
});

// Initialize Vanilla Tilt on project cards
if (typeof VanillaTilt !== 'undefined') {
  VanillaTilt.init(document.querySelectorAll('.project'), {
    max: 15,
    speed: 400,
    glare: true,
    'max-glare': 0.2,
    scale: 1.05
  });
}

// Security Confirm Modal - Create dynamically
const securityModalHTML = `
  <div class="confirm-modal" id="securityModal">
    <div class="confirm-modal__overlay"></div>
    <div class="confirm-modal__content">
      <p class="confirm-modal__message">í•´ë‹¹ í”„ë¡œì íŠ¸ëŠ” ë³´ì•ˆì´ìŠˆë¡œ<br> ì‹œì—°ë™ì˜ìƒìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.</p>
      <div class="confirm-modal__buttons">
        <button class="confirm-modal__btn confirm-modal__btn--confirm confirm-modal__btn--full">í™•ì¸</button>
      </div>
    </div>
  </div>
`;
document.body.insertAdjacentHTML('beforeend', securityModalHTML);

const securityModal = document.getElementById('securityModal');
const securityOverlay = securityModal.querySelector('.confirm-modal__overlay');
const securityConfirm = securityModal.querySelector('.confirm-modal__btn--confirm');
let currentDemoLink = '';

function openSecurityModal(link) {
  currentDemoLink = link;
  securityModal.classList.add('active');
}

function closeSecurityModal() {
  securityModal.classList.remove('active');
  currentDemoLink = '';
}

// Handle Visit Site click for demo video projects
modalLink.addEventListener('click', (e) => {
  const currentProjectTitle = modalTitle.textContent;
  const project = Object.values(projectsData).find(p => p.title === currentProjectTitle);

  if (project && project.demoVideo) {
    e.preventDefault();
    openSecurityModal(project.link);
  } else if (project && project.demoLogin) {
    e.preventDefault();
    openLoginModal(project.link, project.demoLogin.id, project.demoLogin.pw);
  }
});

securityOverlay.addEventListener('click', closeSecurityModal);
securityConfirm.addEventListener('click', () => {
  if (currentDemoLink) {
    window.open(currentDemoLink, '_blank');
  }
  closeSecurityModal();
});

// Login Info Modal - Create dynamically
const loginModalHTML = `
  <div class="confirm-modal" id="loginModal">
    <div class="confirm-modal__overlay"></div>
    <div class="confirm-modal__content">
      <p class="confirm-modal__message">í•´ë‹¹ í”„ë¡œì íŠ¸ëŠ” ë³´ì•ˆì´ìŠˆë¡œ<br>ê°€ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.<br><br><span id="loginCredentials"></span></p>
      <div class="confirm-modal__buttons">
        <button class="confirm-modal__btn confirm-modal__btn--confirm confirm-modal__btn--full">í™•ì¸</button>
      </div>
    </div>
  </div>
`;
document.body.insertAdjacentHTML('beforeend', loginModalHTML);

const loginModal = document.getElementById('loginModal');
const loginOverlay = loginModal.querySelector('.confirm-modal__overlay');
const loginConfirm = loginModal.querySelector('.confirm-modal__btn--confirm');
const loginCredentials = document.getElementById('loginCredentials');
let currentLoginLink = '';

function openLoginModal(link, id, pw) {
  currentLoginLink = link;
  loginCredentials.innerHTML = `<strong>ID:</strong> ${id}<br><strong>PW:</strong> ${pw}`;
  loginModal.classList.add('active');
}

function closeLoginModal() {
  loginModal.classList.remove('active');
  currentLoginLink = '';
}

loginOverlay.addEventListener('click', closeLoginModal);
loginConfirm.addEventListener('click', () => {
  if (currentLoginLink) {
    window.open(currentLoginLink, '_blank');
  }
  closeLoginModal();
});
